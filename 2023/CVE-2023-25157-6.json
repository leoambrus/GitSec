{
    "ID": {
        "GitHub_Advisory_Database": {
            "aliases": [
                "CVE-2023-25157"
            ]
        },
        "Nomisec1": {
            "id": 650178194,
            "name": "CVE-2023-25157",
            "full_name": "win3zz/CVE-2023-25157"
        },
        "Nomisec2": {
            "id": 651841197,
            "name": "CVE-2023-25157",
            "full_name": "0x2458bughunt/CVE-2023-25157"
        },
        "Nomisec3": {
            "id": 652314324,
            "name": "CVE-2023-25157-and-CVE-2023-25158",
            "full_name": "murataydemir/CVE-2023-25157-and-CVE-2023-25158"
        },
        "Nomisec4": {
            "id": 652662180,
            "name": "CVE-2023-25157-checker",
            "full_name": "7imbitz/CVE-2023-25157-checker"
        },
        "Nomisec5": {
            "id": 672729005,
            "name": "CVE-2023-25157",
            "full_name": "Rubikcuv5/CVE-2023-25157"
        },
        "Nomisec6": {
            "id": 724490342,
            "name": "Geoserver-CVE-2023-25157",
            "full_name": "dr-cable-tv/Geoserver-CVE-2023-25157"
        }
    },
    "summary": "GeoServer OGC Filter SQL Injection Vulnerabilities",
    "details": {
        "GitHub_Advisory_Database": "### Impact\n\nGeoServer includes support for the OGC Filter expression language and the OGC Common Query Language (CQL) as part of the Web Feature Service (WFS) and Web Map Service (WMS) protocols.  CQL is also supported through the Web Coverage Service (WCS) protocol for ImageMosaic coverages.\n\nSQL Injection Vulnerabilities have been found with:\n\n* ``PropertyIsLike`` filter, when used with a String field and any database DataStore, or with a PostGIS DataStore with encode functions enabled\n* ``strEndsWith`` function, when used with a PostGIS DataStore with encode functions enabled\n* ``strStartsWith`` function, when used with a PostGIS DataStore with encode functions enabled\n* ``FeatureId`` filter, when used with any database table having a String primary key column and when prepared statements are disabled\n* ``jsonArrayContains`` function, when used with a String or JSON field and with a PostGIS or Oracle DataStore (GeoServer 2.22.0+ only)\n* ``DWithin`` filter, when used with an Oracle DataStore\n\n### Patches\n\n* GeoSever 2.21.4\n* GeoServer 2.22.2\n* GeoServer 2.20.7\n* GeoServer 2.19.7\n* GeoServer 2.18.7\n\n### Workarounds\n\n1. Disabling the PostGIS Datastore *encode functions* setting to mitigate ``strEndsWith``, ``strStartsWith`` vulnerabilities (Like filters have no mitigation, if there is a string field in the feature type published).\n2. Enabling the PostGIS DataStore *preparedStatements* setting to mitigate the ``FeatureId`` vulnerability.\n\n### References\n\n* [OGC Filter SQL Injection Vulnerabilities](https://github.com/geotools/geotools/security/advisories/GHSA-99c3-qc2q-p94m) (GeoTools)\n* [OGC Filter Injection Vulnerability Statement](https://geoserver.org/vulnerability/2023/02/20/ogc-filter-injection.html) (GeoServer Blog)"
    },
    "description": {
        "Nomisec1": "CVE-2023-25157 - GeoServer SQL Injection - PoC",
        "Nomisec2": null,
        "Nomisec3": "GeoServer & GeoTools SQL Injection (CVE-2023-25157 & CVE-2023-25158)",
        "Nomisec4": "A script, written in golang. POC for CVE-2023-25157",
        "Nomisec5": " GeoServer OGC Filter SQL Injection Vulnerabilities",
        "Nomisec6": "Geoserver SQL Injection Exploit"
    },
    "topics": [
        "geoserver",
        "filter",
        "injection",
        "sql",
        "functions",
        "used",
        "string",
        "vulnerabilities",
        "2023",
        "enabled"
    ],
    "severity": [],
    "affected": [],
    "references": [
        {
            "type": "WEB",
            "url": "https://github.com/geoserver/geoserver/security/advisories/GHSA-7g5f-wrx8-5ccf"
        },
        {
            "type": "ADVISORY",
            "url": "https://nvd.nist.gov/vuln/detail/CVE-2023-25157"
        },
        {
            "type": "WEB",
            "url": "https://github.com/geoserver/geoserver/commit/145a8af798590288d270b240235e89c8f0b62e1d"
        },
        {
            "type": "PACKAGE",
            "url": "https://github.com/geoserver/geoserver"
        }
    ],
    "proof_of_concept": {
        "owner1": {
            "html_url": "https://github.com/win3zz"
        },
        "html_url1": "https://github.com/win3zz/CVE-2023-25157",
        "owner2": {
            "html_url": "https://github.com/0x2458bughunt"
        },
        "html_url2": "https://github.com/0x2458bughunt/CVE-2023-25157",
        "owner3": {
            "html_url": "https://github.com/murataydemir"
        },
        "html_url3": "https://github.com/murataydemir/CVE-2023-25157-and-CVE-2023-25158",
        "owner4": {
            "html_url": "https://github.com/7imbitz"
        },
        "html_url4": "https://github.com/7imbitz/CVE-2023-25157-checker",
        "owner5": {
            "html_url": "https://github.com/Rubikcuv5"
        },
        "html_url5": "https://github.com/Rubikcuv5/CVE-2023-25157",
        "owner6": {
            "html_url": "https://github.com/dr-cable-tv"
        },
        "html_url6": "https://github.com/dr-cable-tv/Geoserver-CVE-2023-25157"
    },
    "has_discussions": null,
    "database_specific": {
        "cwe_ids": [
            "CWE-89"
        ],
        "severity": "CRITICAL",
        "github_reviewed": true,
        "github_reviewed_at": "2023-02-22T19:15:56Z",
        "nvd_published_at": "2023-02-21T22:15:00Z"
    },
    "Time_Description": {
        "GitHub_Advisory_Database": {
            "modified": "2023-02-22T19:15:56Z",
            "published": "2023-02-22T19:15:56Z",
            "withdrawn": null
        },
        "Nomisec": {
            "created_at1": "2023-06-06T14:05:09Z",
            "updated_at1": "2024-10-02T00:01:36Z",
            "pushed_at1": "2023-07-14T10:40:17Z",
            "created_at2": "2023-06-10T09:00:16Z",
            "updated_at2": "2023-09-27T05:13:54Z",
            "pushed_at2": "2023-06-10T10:41:08Z",
            "created_at3": "2023-06-11T18:57:18Z",
            "updated_at3": "2024-07-12T14:49:36Z",
            "pushed_at3": "2023-06-11T20:18:09Z",
            "created_at4": "2023-06-12T14:34:14Z",
            "updated_at4": "2023-09-02T16:36:53Z",
            "pushed_at4": "2024-02-02T08:12:39Z",
            "created_at5": "2023-07-31T03:10:41Z",
            "updated_at5": "2023-07-31T19:38:13Z",
            "pushed_at5": "2023-07-31T22:44:42Z",
            "created_at6": "2023-11-28T07:23:00Z",
            "updated_at6": "2024-09-10T16:06:20Z",
            "pushed_at6": "2023-11-28T10:07:24Z"
        }
    }
}