{
    "ID": {
        "GitHub_Advisory_Database": {
            "aliases": [
                "CVE-2023-34458"
            ]
        },
        "Nomisec1": {
            "id": 786354750,
            "name": "CVE-2023-34458-2",
            "full_name": "miguelc49/CVE-2023-34458-2"
        },
        "Nomisec2": {
            "id": 786354762,
            "name": "CVE-2023-34458-1",
            "full_name": "miguelc49/CVE-2023-34458-1"
        },
        "Nomisec3": {
            "id": 786354788,
            "name": "CVE-2023-34458-3",
            "full_name": "miguelc49/CVE-2023-34458-3"
        }
    },
    "summary": "mx-chain-go's relayed transactions always increment nonce",
    "details": {
        "GitHub_Advisory_Database": "### Impact\nWhen executing a relayed transaction, if the inner transaction failed, it would have increased the inner transaction's sender account nonce. This could have contributed to a limited DoS attack on a targeted account. The fix is a breaking change so a new flag `RelayedNonceFixEnableEpoch` was needed. This was a strict processing issue while validating blocks on a chain.\n\n### Patches\nv1.4.17 and later versions contain the fix for this issue\n\n### Workarounds\nthere were no workarounds for this issue. The affected account could only wait for the DoS attack to finish as the attack was not free or to attempt to send transactions in a very fast manner so as to compete on the same nonce with the attacker.\n\n### References\nFor the future understanding of this issue, on v1.4.17 and onwards versions, we have this integration test that addresses the issue and tests the fix. \nhttps://github.com/multiversx/mx-chain-go/blob/babdb144f1316ab6176bf3dbd7d4621120414d43/integrationTests/vm/txsFee/relayedMoveBalance_test.go#LL165C14-L165C14\n"
    },
    "description": {
        "Nomisec1": null,
        "Nomisec2": null,
        "Nomisec3": null
    },
    "topics": [
        "fix",
        "account",
        "issue",
        "chain",
        "attack",
        "workarounds",
        "dos",
        "17",
        "v1",
        "blocks"
    ],
    "severity": [],
    "affected": [],
    "references": [
        {
            "type": "WEB",
            "url": "https://github.com/multiversx/mx-chain-go/security/advisories/GHSA-j494-7x2v-vvvp"
        },
        {
            "type": "ADVISORY",
            "url": "https://nvd.nist.gov/vuln/detail/CVE-2023-34458"
        },
        {
            "type": "WEB",
            "url": "https://github.com/multiversx/mx-chain-go/commit/babdb144f1316ab6176bf3dbd7d4621120414d43"
        },
        {
            "type": "PACKAGE",
            "url": "https://github.com/multiversx/mx-chain-go"
        },
        {
            "type": "WEB",
            "url": "https://github.com/multiversx/mx-chain-go/blob/babdb144f1316ab6176bf3dbd7d4621120414d43/integrationTests/vm/txsFee/relayedMoveBalance_test.go#LL165C14-L165C14"
        },
        {
            "type": "WEB",
            "url": "https://github.com/multiversx/mx-chain-go/releases/tag/v1.4.17"
        }
    ],
    "proof_of_concept": {
        "owner1": {
            "html_url": "https://github.com/miguelc49"
        },
        "html_url1": "https://github.com/miguelc49/CVE-2023-34458-2",
        "owner2": {
            "html_url": "https://github.com/miguelc49"
        },
        "html_url2": "https://github.com/miguelc49/CVE-2023-34458-1",
        "owner3": {
            "html_url": "https://github.com/miguelc49"
        },
        "html_url3": "https://github.com/miguelc49/CVE-2023-34458-3"
    },
    "has_discussions": null,
    "database_specific": {
        "cwe_ids": [
            "CWE-400"
        ],
        "severity": "HIGH",
        "github_reviewed": true,
        "github_reviewed_at": "2023-07-13T17:02:12Z",
        "nvd_published_at": "2023-07-13T19:15:09Z"
    },
    "Time_Description": {
        "GitHub_Advisory_Database": {
            "modified": "2023-07-14T13:28:34Z",
            "published": "2023-07-13T17:02:12Z",
            "withdrawn": null
        },
        "Nomisec": {
            "created_at1": "2024-04-14T07:39:23Z",
            "updated_at1": "2024-04-14T17:39:49Z",
            "pushed_at1": "2024-04-16T00:14:39Z",
            "created_at2": "2024-04-14T07:39:26Z",
            "updated_at2": "2024-04-14T17:39:41Z",
            "pushed_at2": "2024-04-16T00:14:46Z",
            "created_at3": "2024-04-14T07:39:30Z",
            "updated_at3": "2024-04-14T17:39:56Z",
            "pushed_at3": "2024-04-16T00:14:29Z"
        }
    }
}